## 1 mysql 主从复制的过程

::: tip

bin log（二进制日记）：记录DDL和DML，不记录查询

relay log（中继日记）：包含待执行的语句

:::

1. 主库将数据更改斜日 bin log 日志
2. 从库通过I/O线程读取主数据库bin log日志
3. 从库通过将bin log拷贝到 relay log中
4. 从库重做 relay log，完成数据同步

## 2 怎么能解决脏读问题？

脏读问题的解决方法有：

1. 乐观锁：获取数据指定数据的版本号，修改时对版本号检查。
2. 悲观锁：每次获取数据前，都会对该数据加锁，使得任何其他线程都无法获取该数据。
3. 数据库隔离级别：使用可重复读或以上的数据库隔离级别。

## 3 redis是怎么标记失效的

Redis使用key的设置超时来标记key失效，可以用 expire 命令设置

Redis也有自己的数据淘汰策略，超过内存时触发

## 4 redis失效你怎么设计

对于热点数据，为了防止雪崩，一般不设置过期时间

选择合适的淘汰策略，可以根据过期时间、最少使用两个维度或者随机淘汰，一般是使用最少使用的进行淘汰

## 5 红黑树，b树，b+树区别

红黑树是自平衡的二叉树，b树和b+树是多叉树。

b树和b+树：b+树非叶子节点不保存数据，只保存索引，查询效率稳定，节点有指向下一节点的指针，便于范围查询。

## 6 怎么保证redis/mysql一致性（双写一致性）
最终一致性：

1. 使用事务保证双写同时成功或失败。一般先写 mysql，在写redis

2. 可以只写mysql，然后用定时任务或者监听binlog日志，让redis数据和mysql同步
3. 如果是删除可以考虑写mysql，再删redis（失败了重试）

   